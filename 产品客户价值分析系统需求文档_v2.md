# 产品客户价值分析系统需求文档 v2.0

## 1. 项目概述

### 1.1 项目背景
基于现有产品客户价值分析系统框架，开发一个更加强大和复杂的分析系统，用于优化产品结构和客户结构，分析产品价值和客户价值，帮助公司决策哪些单品需要放弃，哪些客户需要放弃。

### 1.2 项目目标
- 提供多维度、多层次的数据分析能力
- 通过丰富的可视化图表呈现分析结果
- 支持产品、客户、地区三个维度的深度分析
- 帮助企业进行精准的产品和客户结构优化决策

## 2. 功能需求

### 2.1 数据上传与处理

#### 2.1.1 Excel文件上传
- 支持用户上传包含多个sheet的Excel文件
- 系统自动识别Excel中的sheet名称（如"分地区"、"分客户"、"分单品"等）
- 用户可选择要分析的具体sheet

#### 2.1.2 数据结构支持
系统需支持三种分析维度，每种维度对应不同的关键字段要求。Excel文件可能包含更多或更少的列，系统需要智能识别和匹配关键字段：

**分单品分析 - 必需关键字段：**
- 物料名称（或产品名称、存货名称、SKU等类似字段）
- 数量
- 毛利
- 其他可选字段：物料基本分类、单价、金额、成本、海运费、陆运费、代办费、吨毛利等

**分客户分析 - 必需关键字段：**
- 客户名称
- 数量  
- 毛利
- 金额
- 其他可选字段：地区、单价、成本、海运费、陆运费、代办费、吨毛利等

**分地区分析 - 必需关键字段：**
- 地区
- 数量
- 毛利
- 其他可选字段：客户名称、单价、金额、成本、海运费、陆运费、代办费、吨毛利等

#### 2.1.3 字段识别规则
系统需要具备智能字段识别能力：
- 支持字段名称的模糊匹配（如"物料名称"、"产品名称"、"SKU"都应识别为产品字段）
- 支持中英文字段名称
- 当Excel包含额外列时，系统忽略非关键列
- 当缺少关键字段时，系统提示用户并拒绝处理
- 自动识别数值类型字段和文本类型字段

#### 2.1.4 数据单位转换风险控制
- **废除自动转换规则**：系统不再进行任何默认的单位自动转换。
- **新增强制确认步骤**：在数据上传成功、字段匹配完成之后，正式执行分析之前，系统必须弹出一个强制确认界面。
- **界面要求**：
    - 界面需清晰展示系统识别出的关键数值字段，特别是“数量”和“毛利/金额”。
    - 用户必须通过单选框手动确认这些字段的原始单位。
    - **示例**：
        - **数量单位确认**: 您上传的“数量”字段单位是？ (o) 千克 (kg)  ( ) 吨 (t)
        - **金额单位确认**: 您上传的“毛利”、“金额”字段单位是？ (o) 元  ( ) 万元
- **处理逻辑**：系统严格根据用户在确认界面中的选择来执行后续的单位转换计算（如 kg -> t, 元 -> 万元）或跳过转换。只有用户完成确认后，才能进入分析页面。

### 2.2 分析维度选择
用户上传Excel后，系统提供三个分析维度选择：
- 分单品分析
- 分客户分析  
- 分地区分析

## 3. 分析功能详细需求

### 3.1 分单品分析

#### 3.1.1 核心分析指标
- 销量（吨）
- 吨毛利（元/吨）
- 总金额（万元）
- 总毛利（万元）
- 成本分析指标（辅助分析）：
  - 总成本（万元）= 成本 + 海运费 + 陆运费 + 代办费
  - 成本率 = 总成本/总金额
  - 成本构成分析（成本、海运费、陆运费、代办费占比）

#### 3.1.2 可视化分析图表

**1. 四象限散点图分析与策略洞察**
- **图表设计**：
    - X轴：销量（吨）
    - Y轴：吨毛利（元/吨）
    - 散点大小：可表示总金额或总毛利
    - 四象限划分：以销量和吨毛利的平均值为分割线。
- **策略洞察卡片**：
    - 在四象限图的旁边或下方，并排展示四个“策略洞察卡片”，每个卡片对应一个象限。
    - **卡片内容**：象限名称、特征、产品数量、基础策略建议。
    - **策略详情**：
        - **象限I (明星产品)**: 高毛利, 高销量。策略: 重点保护与投入，保证产能、优先备货、加大营销。
        - **象限II (金牛产品)**: 低毛利, 高销量。策略: 优化成本与关联销售，审视生产流程，利用其流量。
        - **象限III (潜力产品)**: 高毛利, 低销量。策略: 精准营销与试错，分析销量低的原因。
        - **象限IV (瘦狗产品)**: 低毛利, 低销量。策略: 简化或淘汰，评估战略保留价值。

**2. 销量分布区间分析**
- 可视化展示不同销量区间的产品分布
- 区间设置：<5吨、5-10吨、10-20吨、20-50吨、>50吨（可自定义）
- 柱状图或饼图展示各区间产品数量和占比

**3. SKU贡献度分析**
- 展示每个SKU创造的销量和利润贡献
- 可通过柱状图、堆叠图等形式展示
- 支持按贡献度排序

**4. 帕累托曲线（80/20法则）**
- 展示产品销量或利润的帕累托分布
- 识别核心产品（贡献80%业绩的20%产品）
- 曲线图展示累计贡献率

**5. 盈亏分析**
- 识别并标记亏损产品（毛利为负的产品）
- 可视化展示盈利产品vs亏损产品分布
- 提供应舍弃SKU建议列表

**6. 成本分析图表（辅助分析，非重点）**
- 成本构成饼图：展示成本、海运费、陆运费、代办费的占比
- 成本率分布图：展示不同产品的成本率分布情况
- 成本效率散点图：成本率 vs 销量，识别高成本低效产品

#### 3.1.3 明细数据查看
- 支持点击图表查看具体产品明细
- 提供产品明细表格，包含所有字段信息
- 支持按各字段排序和筛选

### 3.2 分客户分析

#### 3.2.1 核心分析指标
- 采购金额（万元）
- 毛利贡献（万元）
- 采购数量（吨）
- 客户毛利率
- 成本分析指标（辅助分析）：
  - 客户总成本（万元）= 成本 + 海运费 + 陆运费 + 代办费
  - 客户成本率 = 总成本/采购金额
  - 客户成本效率分析

#### 3.2.2 可视化分析图表

**1. 四象限散点图分析与策略洞察**
- **图表设计**：
    - X轴：采购金额（万元）
    - Y轴：毛利贡献（万元）
    - 四象限划分：以采购金额和毛利贡献的平均值为分割线。
- **策略洞察卡片**：
    - 同样配置“策略洞察卡片”，内容包括象限名称、特征、客户数量、基础策略建议。
    - **策略详情**：
        - **象限I (价值客户)**: 高金额, 高毛利。策略: 深度合作，提供VIP服务，倾斜资源。
        - **象限II (规模客户)**: 高金额, 低毛利。策略: 提升利润空间，优化产品组合，减少价格敏感度。
        - **象限III (潜力客户)**: 低金额, 高毛利。策略: 重点培育，挖掘深层需求，提升采购额。
        - **象限IV (一般客户)**: 低金额, 低毛利。策略: 标准化服务，维持关系，避免资源过度投入。

**2. 客户价值分布区间分析**
- 按采购金额分区间：<10万、10-50万、50-100万、100-500万、>500万
- 可视化展示各区间客户数量和贡献

**3. 客户贡献度分析**
- 展示每个客户的金额和毛利贡献
- 支持多维度排序和对比

**4. 客户帕累托曲线**
- 展示客户价值的帕累托分布
- 识别核心客户群体

**5. 客户盈亏分析**
- 识别亏损客户或低价值客户
- 提供客户优化建议

**6. 客户成本分析图表（辅助分析，非重点）**
- 客户成本构成分析：展示各客户的成本、海运费、陆运费、代办费占比
- 客户成本率分布图：展示不同客户的成本率分布情况
- 客户成本效率分析：成本率 vs 采购金额，识别高成本低效客户

#### 3.2.3 明细数据查看
- 客户详细信息表格
- 支持按地区、金额、毛利等维度筛选

### 3.3 分地区分析

#### 3.3.1 核心分析指标
- 地区销售金额（万元）
- 地区毛利贡献（万元）
- 地区销售数量（吨）
- 地区客户数量
- 成本分析指标（辅助分析）：
  - 地区总成本（万元）= 成本 + 海运费 + 陆运费 + 代办费
  - 地区成本率 = 总成本/销售金额
  - 地区成本效率对比分析

#### 3.3.2 可视化分析图表

**1. 地区四象限散点图分析与策略洞察**
- **图表设计**：
    - X轴：地区销售金额（万元）
    - Y轴：地区毛利贡献（万元）
    - 四象限划分：以销售金额和毛利贡献的平均值为分割线。
- **策略洞察卡片**：
    - 配置“策略洞察卡片”，内容包括象限名称、特征、地区数量、基础策略建议。
    - **策略详情**：
        - **象限I (核心市场)**: 高金额, 高毛利。策略: 重点投入资源，建立并巩固区域性的竞争壁垒。可作为新产品、新策略的首发试点区域，持续扩大领先优势。
        - **象限II (规模市场)**: 高金额, 低毛利。策略: 核心目标是提升利润率。需深入分析该区域的产品销售结构，减少对低毛利产品的依赖，通过激励政策引导销售团队推广高毛利的产品组合。同时，优化物流和渠道成本。
        - **象限III (机会市场)**: 低金额, 高毛利。策略: 精准定位并渗透区域内的高价值客户群体。加强品牌推广，积极扶持核心经销商或合作伙伴，目标是投入资源将其逐步培养为新的“核心市场”。
        - **象限IV (边缘市场)**: 低金额, 低毛利。策略: 维持最低成本运营。采用标准化服务流程，不投入额外的市场资源。定期复评其战略价值和潜力，若长期无改善，应考虑收缩业务或战略性放弃。

**2. 地区价值分布区间分析**
- 按销售金额分区间展示各地区分布
- 可视化展示各区间地区数量和贡献

**3. 地区贡献度分析**
- 展示每个地区的金额和毛利贡献
- 支持多维度排序和对比

**4. 地区帕累托曲线**
- 展示地区价值的帕累托分布
- 识别核心地区市场

**5. 地区盈亏分析**
- 识别亏损地区或低价值地区
- 提供地区市场优化建议

**6. 地区成本分析图表（辅助分析，非重点）**
- 地区成本构成分析：展示各地区的成本、海运费、陆运费、代办费占比
- 地区成本率分布图：展示不同地区的成本率分布情况
- 地区成本效率分析：成本率 vs 销售金额，识别高成本低效地区

#### 3.3.3 明细数据查看
- 地区详细信息表格
- 支持按客户、金额、毛利等维度筛选

## 4. 技术需求

### 4.1 前端技术栈
- HTML5 + CSS3 + JavaScript
- 图表库：推荐使用 ECharts 或 Chart.js
- 响应式设计，支持多设备访问

### 4.2 后端技术栈
- Python Flask 框架
- pandas 用于数据处理
- openpyxl 用于Excel文件处理

### 4.3 数据处理要求
- 支持大文件上传（建议支持50MB以内）
- 数据处理性能优化
- 异常数据处理和提示

## 5. 用户界面需求

### 5.1 分析页面布局
采用“由主到次，由宏观到微观”的布局思路：
- **页面顶部**: 放置核心的“四象限散点图”和对应的“策略洞察卡片”，作为视觉和决策的焦点。
- **页面中部**: 放置补充分析图表，如“帕累托曲线”和“销量/价值分布区间图”，用于提供更深层次的上下文和佐证。
- **页面底部**: 放置“明细数据表格”，支持与上方所有图表进行联动筛选，方便用户钻取查询具体数据。

### 5.2 交互设计
- 图表支持缩放、平移、点击交互
- 数据表格支持排序、筛选、分页
- 支持图表和数据的联动显示

## 6. 导出功能需求

### 6.1 导出Excel报告结构
将导出的Excel报告结构最终确定为以下四个Sheet：
- **Sheet 1: “分析概要 (Report)”**: 作为报告的封面。应包含分析标题、分析执行时间、核心战略结论（可由系统根据各象限数据分布生成初步建议）。
- **Sheet 2: “可视化图表 (Charts)”**: 包含分析页面生成的所有核心图表（如四象限图、帕累托图等）的静态图片，方便直接用于报告或演示。
- **Sheet 3: “分析结果数据 (Analyzed Data)”**: 经过聚合后的分析数据。例如，在“分单品”分析中，每行代表一个单品，列包括总销量、总毛利、吨毛利等核心指标，并新增两列：**[象限归类]** (如“明星产品”) 和 **[建议策略]** (如“重点保护与投入...”)。
- **Sheet 4: “原始数据 (含标注)” (Raw Data with Tags)**: 完整复制用户上传的原始数据，并在最后一列为每一行数据动态标注其所属的象限归类（例如，某条销售记录属于“明星产品”）。

### 6.2 导出格式
- Excel格式（.xlsx）

## 7. 性能需求
- 页面加载时间 < 3秒
- 数据处理时间 < 30秒（中等规模数据）
- 图表渲染时间 < 5秒
- 支持并发用户数 > 10

## 8. 安全需求
- 上传文件类型验证
- 文件大小限制
- 数据临时存储，定期清理
- 防止恶意文件上传

## 9. 兼容性需求
- 支持主流浏览器：Chrome、Firefox、Safari、Edge
- 支持移动端访问
- Excel文件兼容性：支持.xlsx、.xls格式

## 10. 扩展性考虑
- 预留自定义分析指标接口
- 支持更多图表类型扩展
- 支持更多数据源格式
- 预留API接口用于系统集成

## 11. 项目交付物
- 完整的Web应用系统
- 源代码及注释
- 部署文档
- 用户操作手册
- 测试报告

---

**文档版本**：v2.0  
**创建日期**：2025年7月15日  
**最后更新**：2025年7月15日