# 产品客户价值分析系统

基于四象限分析的智能决策支持系统，帮助企业优化产品结构和客户结构。

## 功能特性

### 🎯 核心功能
- **多维度分析**: 支持分单品、分客户、分地区三个维度的深度分析
- **四象限分析**: 基于销量/金额和毛利的四象限战略分析
- **智能字段识别**: 自动识别Excel文件中的关键字段
- **单位转换确认**: 强制用户确认数据单位，避免分析错误
- **可视化图表**: 丰富的ECharts图表展示分析结果
- **Excel报告导出**: 四层Sheet结构的完整分析报告

### 📊 分析图表
- 四象限散点图 + 策略洞察卡片
- 帕累托分析曲线（80/20法则）
- 分布区间分析图
- 盈亏分析图
- 贡献度分析图
- 交互式明细数据表格

### 🎨 用户体验
- 响应式设计，支持多设备访问
- 拖拽上传文件
- 实时进度提示
- 图表联动筛选
- 一键导出报告

## 技术架构

### 后端技术栈
- **Python 3.7+**
- **Flask**: Web框架
- **Pandas**: 数据处理
- **OpenPyXL**: Excel文件读写
- **NumPy**: 数值计算

### 前端技术栈
- **HTML5 + CSS3 + JavaScript**
- **ECharts**: 图表可视化
- **响应式设计**

## 安装部署

### 1. 环境要求
```bash
Python 3.7+
```

### 2. 安装依赖
```bash
pip install -r requirements.txt
```

或者手动安装：
```bash
pip install Flask pandas openpyxl xlrd numpy
```

### 3. 启动应用
```bash
python app.py
```

或使用启动脚本：
```bash
python run.py
```

### 4. 访问系统
打开浏览器访问：`http://localhost:5000`

## 使用指南

### 1. 数据准备
系统支持Excel文件（.xlsx/.xls格式），需要包含以下关键字段：

#### 分单品分析必需字段：
- **产品字段**: SKU、物料名称、产品名称、存货名称、物料、单品
- **数量字段**: 数量、销量、销售数量
- **毛利字段**: 毛利、利润、毛利润

#### 分客户分析必需字段：
- **客户字段**: 客户名称、客户、客户全称
- **数量字段**: 数量、销量、销售数量
- **毛利字段**: 毛利、利润、毛利润
- **金额字段**: 金额、销售额、含税金额

#### 分地区分析必需字段：
- **地区字段**: 地区、区域、省份
- **数量字段**: 数量、销量、销售数量
- **毛利字段**: 毛利、利润、毛利润

### 2. 操作流程

#### 步骤1: 上传文件
- 点击上传区域或拖拽Excel文件
- 系统自动读取并显示所有Sheet

#### 步骤2: 选择工作表
- 从列表中选择要分析的Sheet
- 点击"下一步：字段检测"

#### 步骤3: 字段检测
- 系统自动识别关键字段
- 选择分析维度（分单品/分客户/分地区）
- 点击"下一步：单位确认"

#### 步骤4: 单位确认
- 确认数量字段单位（千克/吨）
- 确认金额字段单位（元/万元）
- 点击"开始分析"

#### 步骤5: 查看结果
- 查看四象限分析和策略建议
- 浏览补充分析图表
- 筛选和查看明细数据
- 导出Excel分析报告

### 3. 四象限策略解读

#### 分单品分析：
- **象限I (明星产品)**: 高毛利+高销量 → 重点保护与投入
- **象限II (金牛产品)**: 低毛利+高销量 → 优化成本与关联销售
- **象限III (潜力产品)**: 高毛利+低销量 → 精准营销与试错
- **象限IV (瘦狗产品)**: 低毛利+低销量 → 简化或淘汰

#### 分客户分析：
- **象限I (核心客户)**: 高金额+高毛利 → 战略合作，VIP服务
- **象限II (增利客户)**: 高金额+低毛利 → 提升利润空间
- **象限III (成长客户)**: 低金额+高毛利 → 扶持与渗透
- **象限IV (机会客户)**: 低金额+低毛利 → 标准化服务

#### 分地区分析：
- **象限I (核心市场)**: 高金额+高毛利 → 重点投入资源
- **象限II (规模市场)**: 高金额+低毛利 → 优化成本结构
- **象限III (机会市场)**: 低金额+高毛利 → 精准定位渗透
- **象限IV (边缘市场)**: 低金额+低毛利 → 最低成本运营

## 示例数据

运行以下命令生成示例数据：
```bash
python create_sample_data.py
```

这将创建一个包含三个Sheet的示例Excel文件，可用于测试系统功能。

## 导出报告结构

系统导出的Excel报告包含四个工作表：

1. **分析概要 (Report)**: 报告封面和四象限概要
2. **可视化图表 (Charts)**: 图表占位符（实际应用中可插入图片）
3. **分析结果数据 (Analyzed Data)**: 聚合分析数据 + 象限归类 + 策略建议
4. **原始数据 (含标注) (Raw Data with Tags)**: 原始数据 + 象限标注

## 系统限制

- 文件大小限制：50MB
- 支持格式：.xlsx, .xls
- 并发用户：建议不超过10个
- 数据处理时间：中等规模数据 < 30秒

## 故障排除

### 常见问题

1. **字段识别失败**
   - 检查Excel列名是否符合系统识别规则
   - 确保必需字段存在

2. **单位转换错误**
   - 仔细确认原始数据的单位
   - 重新进行单位确认

3. **分析结果异常**
   - 检查数据质量（空值、异常值）
   - 确认数据类型正确

4. **导出失败**
   - 检查磁盘空间
   - 确保有写入权限

## 开发说明

### 项目结构
```
├── app.py              # Flask主应用
├── analyzer.py         # 数据分析核心模块
├── utils.py           # 工具函数
├── exporter.py        # Excel导出模块
├── requirements.txt   # 依赖包列表
├── templates/         # HTML模板
├── static/           # 静态资源
├── uploads/          # 上传文件目录
└── exports/          # 导出文件目录
```

### 扩展开发
- 添加新的分析维度
- 扩展图表类型
- 集成更多数据源
- 添加用户权限管理

## 许可证

本项目基于MIT许可证开源。

## 联系方式

如有问题或建议，请联系开发团队。

---

**版本**: v2.0  
**更新日期**: 2025-07-15  
**开发者**: Augment Agent
